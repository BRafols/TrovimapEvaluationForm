var VueTrovimapWizard=function(t,e,a,r,n){"use strict";function o(t,e,a,r,n,o,s,i,l,c){"boolean"!=typeof s&&(l=i,i=s,s=!1);var d,p="function"==typeof a?a.options:a;if(t&&t.render&&(p.render=t.render,p.staticRenderFns=t.staticRenderFns,p._compiled=!0,n&&(p.functional=!0)),r&&(p._scopeId=r),o?(d=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},p._ssrRegister=d):e&&(d=s?function(t){e.call(this,c(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,i(t))}),d)if(p.functional){var v=p.render;p.render=function(t,e){return d.call(e),v(t,e)}}else{var u=p.beforeCreate;p.beforeCreate=u?[].concat(u,d):[d]}return a}a=a&&a.hasOwnProperty("default")?a.default:a,r=r&&r.hasOwnProperty("default")?r.default:r,n=n&&n.hasOwnProperty("default")?n.default:n;var s=o({render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{on:{click:function(e){return t.$emit("click")}}},[a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:t._s(t.parcel.Id)}}),t._v(" "),a("v-list-tile-sub-title",[t._v("\n            "+t._s(t.parcel.StreetName)+", "+t._s(t.parcel.StreetNumber)+", "+t._s(t.parcel.Province)+"\n        ")])],1)],1)},staticRenderFns:[]},void 0,{props:{parcel:{type:Object,required:!0}},methods:{selectParcel:function(){this.$store.dispatch("trovimap/FETCH_BUILDING_UNITS_BY_PARCEL",this.parcel.Id)}}},void 0,!1,void 0,!1,void 0,void 0,void 0),i=o({render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list",{attrs:{"three-line":""}},t._l(t.items,function(e){return a("parcel-list-element",{key:e.Id,attrs:{parcel:e},on:{click:function(a){return t.$emit("selected",e)}}})}),1)},staticRenderFns:[]},void 0,{components:{ParcelListElement:s},computed:{items:function(){return this.$store.state.trovimap.parcels}}},void 0,!1,void 0,!1,void 0,void 0,void 0),l=o({render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-text-field",{attrs:{name:"address",label:"Address",id:"address",placeholder:"Calle Valencia 359, 08002, Barcelona"},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getParcelsByAddress(e)}},model:{value:t.address,callback:function(e){t.address=e},expression:"address"}})],1),t._v(" "),a("v-flex",{attrs:{xs12:""}},[a("v-btn",{attrs:{block:"",color:"primary",disabled:t.loading},on:{click:t.getParcelsByAddress}},[t._v("\n            Buscar\n        ")])],1),t._v(" "),t.loading?a("v-flex",{attrs:{xs12:"","text-sm-center":""}},[a("v-progress-circular",{attrs:{indeterminate:"",color:"primary"}})],1):a("v-flex",{attrs:{xs12:""}},[a("parcel-list",{on:{selected:t.parcelSelected}})],1)],1)},staticRenderFns:[]},void 0,{data:function(){return{address:"Calle Gas, 31, 08800",loading:!1,response:{}}},components:{ParcelList:i},methods:{getParcelsByAddress:async function(){this.loading=!0;try{await this.$store.dispatch("trovimap/FETCH_PARCELS_BY_ADDRESS",this.address)}catch(t){this.response=Object.assign({},t.data)}finally{this.loading=!1}},parcelSelected:function(t){console.log("parcelByAddress"),this.$emit("addressSelected",t)}}},void 0,!1,void 0,!1,void 0,void 0,void 0),c=o({render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list-tile",{attrs:{actions:""},on:{click:function(e){return t.$emit("click")}}},[a("v-list-tile-content",[a("v-list-tile-title",{domProps:{innerHTML:t._s(t.apartment.FormattedAddress)}}),t._v(" "),a("v-list-tile-sub-title",[t._v("\n            Piso: "+t._s(t.apartment.Floor)+" | Puerta "+t._s(t.apartment.Door)+" | Fecha construcción: "+t._s(t.apartment.YearBuilt)+" | m2: "+t._s(t.apartment.LivingArea)+"\n        ")]),t._v(" "),a("v-list-tile-sub-title",[t._v("\n            Referencia catastral: "),a("b",[t._v(t._s(t.apartment.CadastralReference))])])],1)],1)},staticRenderFns:[]},void 0,{props:{apartment:{type:Object,required:!0}}},void 0,!1,void 0,!1,void 0,void 0,void 0),d=o({render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-list",{attrs:{"three-line":""}},t._l(t.items,function(e){return a("apartment-list-element",{key:e.Id,attrs:{apartment:e},on:{click:function(a){return t.$emit("selected",e)}}})}),1)},staticRenderFns:[]},void 0,{components:{ApartmentListElement:c},props:{items:{type:Array,default:function(){return[]}}}},void 0,!1,void 0,!1,void 0,void 0,void 0),p=o({render:function(){var t=this.$createElement,e=this._self._c||t;return e("v-layout",{attrs:{row:"",wrap:""}},[e("v-flex",{attrs:{xs12:""}},[this._v("\n        "+this._s(this.Id)+"\n    ")]),this._v(" "),e("v-flex",{attrs:{xs12:""}},[e("apartment-list",{attrs:{items:this.apartments},on:{selected:this.apartmentSelected}})],1)],1)},staticRenderFns:[]},void 0,{props:{Id:{required:!0,type:String}},components:{ApartmentList:d},mounted:function(){this.$store.dispatch("trovimap/FETCH_BUILDING_UNITS_BY_PARCEL",this.Id)},computed:{apartments:function(){return this.$store.getters["trovimap/apartmentsById"](this.Id)}},methods:{apartmentSelected:function(t){this.$emit("apartmentSelected",t)}}},void 0,!1,void 0,!1,void 0,void 0,void 0),v=o({render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-sheet",{attrs:{color:"rgba(0, 0, 0, .12)"}},[a("v-sparkline",{attrs:{value:t.items,color:"rgba(255, 255, 255, .7)",height:"100",padding:"24",smooth:""},scopedSlots:t._u([{key:"label",fn:function(e){return[t._v("\n          "+t._s(e.value)+"\n        ")]}}])})],1)},staticRenderFns:[]},void 0,{props:{items:{type:Array,required:!0}},data:function(){return{value:[423,446,675,510,590,610,760]}}},void 0,!1,void 0,!1,void 0,void 0,void 0),u=o({render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-form",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:"",sm4:""}},[a("v-text-field",{attrs:{name:"surface",label:"Superfície",id:"surface"},model:{value:t.payload.LivingArea,callback:function(e){t.$set(t.payload,"LivingArea",e)},expression:"payload.LivingArea"}})],1),t._v(" "),a("v-flex",{attrs:{xs12:"",sm4:""}},[a("v-text-field",{attrs:{name:"bathrooms",label:"Número de baños",id:"bathrooms"},model:{value:t.payload.Bathrooms,callback:function(e){t.$set(t.payload,"Bathrooms",e)},expression:"payload.Bathrooms"}})],1),t._v(" "),a("v-flex",{attrs:{xs12:"",sm4:""}},[a("v-text-field",{attrs:{name:"bedrooms",label:"Número de habitaciones",id:"bedrooms"},model:{value:t.payload.Bedrooms,callback:function(e){t.$set(t.payload,"Bedrooms",e)},expression:"payload.Bedrooms"}})],1),t._v(" "),a("v-btn",{attrs:{color:"primary",block:""},on:{click:t.fetchEvaluation}},[t._v("Obtener valoración")])],1)],1)],1),t._v(" "),t.evaluation?a("v-flex",{attrs:{xs12:""}},[a("price-evolution",{attrs:{items:t.priceItems}})],1):t._e()],1)},staticRenderFns:[]},void 0,{props:{apartmentId:{type:String,required:!0},apartment:{type:Object,required:!0},parcel:{type:Object,required:!0}},data:function(){return{payload:{ApartmentId:this.apartmentId,Bathrooms:0,Bedrooms:0}}},mounted:function(){this.fetchCharacteristics()},components:{PriceEvolution:v},computed:{evaluation:function(){return this.$store.state.trovimap.evaluations[this.apartmentId]},priceItems:function(){return this.evaluation.historicalStats.aggregations.map(function(t){return Math.round(100*t.pricem2.avg+Number.EPSILON)/100}).slice(0,8)}},methods:{fetchEvaluation:function(){this.$store.dispatch("trovimap/FETCH_EVALUATION_BY_APARTMENT_ID",{payload:this.payload,apartmentId:this.apartmentId})},fetchCharacteristics:async function(){this.loadingCharacteristics=!0;try{var t=await this.$store.dispatch("trovimap/FETCH_CHARACTERISTICS_BY_APARTMENT_ID",this.apartmentId);this.payload=Object.assign({},this.payload,{ParcelId:t.ParcelId,CadastralReference:t.CadastralReference,Location:{lat:t.Location.lat,lon:t.Location.lon},LivingArea:t.LivingArea})}catch(t){throw t}finally{this.loadingCharacteristics=!1}},download:async function(){try{var t=await this.$store.dispatch("trovimap/DOWNLOAD_EVALUATION_BY_ID",this.evaluation.id);console.log("response",t),this.forceFileDownload(t)}catch(t){throw t}},forceFileDownload:function(t){var a=new Blob([t.data],{type:t.headers.context-e.type});console.log("blob",a),console.log("blob",t.data);var r=document.createElement("a");r.href=window.URL.createObjectURL(a),r.download="download.pdf",r.click()}},watch:{apartmentId:function(){this.fetchCharacteristics()}}},void 0,!1,void 0,!1,void 0,void 0,void 0),m=o({render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{attrs:{xs12:""}},[a("v-stepper",{model:{value:t.stepperValue,callback:function(e){t.stepperValue=e},expression:"stepperValue"}},[a("v-stepper-header",[a("v-stepper-step",{attrs:{step:"1",complete:t.stepperValue>1}},[t._v("Name of step 1")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{step:"2",complete:t.stepperValue>2}},[t._v("Name of step 2")]),t._v(" "),a("v-divider"),t._v(" "),a("v-stepper-step",{attrs:{step:"3",complete:t.stepperValue>3}},[t._v("Name of step 3")])],1),t._v(" "),a("v-stepper-items",[a("v-stepper-content",{attrs:{step:"1"}},[a("parcel-by-address",{on:{addressSelected:this.onAddressSelected}}),t._v(" "),a("v-btn",{attrs:{color:"primary",disabled:!t.address.Id},nativeOn:{click:function(e){t.stepperValue=2}}},[t._v("\n                        Continue\n                    ")]),t._v(" "),a("v-btn",{attrs:{flat:""}},[t._v("Cancel")])],1),t._v(" "),a("v-stepper-content",{attrs:{step:"2"}},[t.address.Id?a("building-unit",{attrs:{Id:t.address.Id},on:{apartmentSelected:this.onApartmentSelected}}):t._e(),t._v(" "),a("v-btn",{attrs:{color:"primary",disabled:!t.apartment.Id},nativeOn:{click:function(e){t.stepperValue=3}}},[t._v("\n                        Continue\n                    ")]),t._v(" "),a("v-btn",{attrs:{flat:""},nativeOn:{click:function(e){t.stepperValue=1}}},[t._v("Cancel")])],1),t._v(" "),a("v-stepper-content",{attrs:{step:"3"}},[t.apartment.Id?a("evaluation-element",{attrs:{parcel:t.address,apartment:t.apartment,apartmentId:t.apartment.Id}}):t._e()],1)],1)],1)],1),t._v(" "),a("v-flex",{attrs:{xs12:""}},[t._v("\n        Address: "+t._s(t.address)+"\n    ")]),t._v(" "),a("v-flex",{attrs:{xs12:""}},[t._v("\n        apartment: "+t._s(t.apartment)+"\n    ")])],1)},staticRenderFns:[]},void 0,{data:function(){return{name:"borja",stepperValue:1,address:{},apartment:{}}},components:{ParcelByAddress:l,BuildingUnit:p,EvaluationElement:u},methods:{onAddressSelected:function(t){this.address=t},onApartmentSelected:function(t){this.apartment=t}}},void 0,!1,void 0,!1,void 0,void 0,void 0),f={FETCH_PARCELS_BY_ADDRESS:async function(t,e){var a=t.commit;console.log("context",t);try{a("SET_PARCELS",(await r.get("http://localhost:8080/trovi/parcel?address="+e)).data),console.log("tex",e)}catch(t){throw t}},FETCH_BUILDING_UNITS_BY_PARCEL:async function(t,e){var a=t.commit;try{a("SET_BUILDING_UNITS",(await r.get("http://localhost:8080/trovi/parcel/"+e)).data)}catch(t){throw t}},FETCH_EVALUATION_BY_APARTMENT_ID:async function(t,e){var a=t.commit,n=e.payload,o=e.apartmentId;try{var s=await r.post("http://localhost:8080/trovi/apartment/"+o,n);console.log("resukt",s),a("SET_APARTMENT",Object.assign({},s.data,{apartmentId:o}))}catch(t){throw t}},DOWNLOAD_EVALUATION_BY_ID:async function(t,e){try{return await r.get("http://localhost:8080/trovi/evaluation/"+e,{responseType:"arraybuffer"})}catch(t){throw t}},FETCH_CHARACTERISTICS_BY_APARTMENT_ID:async function(t,e){try{var a=await r.get("http://localhost:8080/trovi/apartment/"+e+"/characteristics");return{ApartmentId:a.data.ApartmentId,ParcelId:a.data.ParcelId,CadastralReference:a.data.CadastralReference,Location:{lat:a.data.Location.lat,lon:a.data.Location.lon},LivingArea:a.data.LivingArea}}catch(t){throw t}}},_={SET_PARCELS:function(t,e){n.set(t,"parcels",e)},SET_BUILDING_UNITS:function(t,e){n.set(t.buildingUnits,e.Id,e.Apartments)},SET_APARTMENT:function(t,e){var a=e.apartmentId;n.set(t.evaluations,a,e)}};console.log(_);var h=function(){return console.log("createModule"),{namespaced:!0,state:{parcels:[],buildingUnits:{},evaluations:{}},actions:Object.assign({},f),mutations:Object.assign({},_),getters:{apartmentsById:function(t){return function(e){var a=t.buildingUnits[e];return a?a.sort(function(t,e){return t.Floor===e.Floor?t.Door<e.Door?-1:1:t.Floor<e.Floor?-1:1}):a}}}}};function y(t,e){void 0===e&&(e={}),y.installed||(e.store||console.warn("Please provide a store!!"),e.axios||console.warn("Please provide a axios instance!!"),y.installed=!0,t.prototype.axios=e.axios,e.store.registerModule("trovimap",h()),console.log("Vue.component",t.component),t.component("TrovimapWizard",m),t.component("ParcelByAddress",l),t.component("ParcelList",i),t.component("ParcelListElement",s),t.component("ApartmentList",d),t.component("ApartmentListElement",c),t.component("BuildingUnit",p),t.component("EvaluationElement",u),t.component("PriceEvolution",v))}var I={install:y},A=null;return"undefined"!=typeof window?A=window.Vue:"undefined"!=typeof global&&(A=global.Vue),A&&A.use(I),m.install=y,t.ParcelByAddress=l,t.TrovimapWizard=m,t.default=m,t}({},os,Vuex,axios,Vue);